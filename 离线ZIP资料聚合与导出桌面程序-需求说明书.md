# 离线ZIP资料聚合与导出桌面程序——需求说明书（草案）

## 1. 背景与目标
用户需要一个桌面程序，用于批量导入ZIP压缩包，在离线环境下解压并提取其中的 Word、PDF、图片、视频等文件，统一展示与预览；并支持两类核心导出：选择已导入的多个ZIP，将这些ZIP对应的结构化信息批量导出到一个Excel表格中；将多个ZIP及ZIP内选定文件（Word/PDF片段/图片/视频/原始ZIP等）批量汇总导出到一个Word文档中（包含附件/嵌入文件）。

## 2. 运行与开发环境
开发环境：macOS  
运行环境：Windows PC  
网络要求：必须完全离线运行（不依赖外部服务）

## 3. 数据规模与约束
单次导入 ZIP 数量：≤ 50 个  
单次导入总容量：≤ 100MB  
Word：固定模板（可按模板规则稳定抽取字段）  
PDF：无需 OCR（不处理扫描件识别）  
低端机适配：运行时尽量少占用系统资源（CPU/内存/磁盘IO）

## 4. 用户角色与核心流程
### 4.1 角色
操作员：导入ZIP、查看预览、勾选导出内容、发起导出、下载/保存导出结果  
管理/复核人员（可选）：校验结构化字段、复核导出结果

### 4.2 核心流程（概览）
批量导入 ZIP → 解压与文件归类（Word/PDF/图片/视频/其他） → 统一展示与预览（在一个界面聚合呈现） → Word 模板字段结构化抽取（可校对） → 选择ZIP批量导出 Excel（结构化字段） → 选择ZIP及文件内容 → 汇总导出 Word（一个文档，含选定内容与附件）

## 5. 功能需求
### 5.1 批量导入 ZIP
支持一次选择多个 ZIP 文件导入；导入后自动解压（或建立索引并按需解压，具体由设计决定）；识别 ZIP 内文件类型：Word（docx）、PDF、图片（jpg/png等）、视频（mp4等）、其他文件；记录每个 ZIP 的处理状态（未处理/处理中/成功/失败），并能查看失败原因。

### 5.2 文件内容提取与统一展示
将导入批次内各 ZIP 的文件条目统一汇总展示（可按 ZIP、文件类型、文件名筛选/排序）；可查看每个文件的基本信息：名称、类型、大小、来源ZIP、路径、导入时间等。

预览能力要求（“展示到一起”的核心）：图片可预览；视频可预览（播放）或至少可展示封面/基本信息，且导出时文件必须随Word带出；PDF可预览并支持“选择某些内容”（例如页范围/关键字命中等，具体交互由设计决定）；Word 可解析内容，至少能展示模板字段与关键内容（无需100%还原排版）。

### 5.3 Word 模板结构化抽取 → 导出 Excel
Word 为固定模板：从 ZIP 内的 Word（docx）中抽取“有信息”的字段（字段清单与定位方式由模板规则定义）；抽取后形成结构化数据记录（与来源 ZIP/Word 文件关联）。

导出 Excel 的核心要求：用户在已导入的 ZIP 列表中勾选一个或多个 ZIP，点击导出后将这些 ZIP 的结构化信息批量汇总到**同一个** Excel 文件中；每条结构化记录对应一行，字段列固定且可追溯来源（例如ZIP名/Word文件名/导入批次等）。

### 5.4 汇总导出到一个 Word（用户选择驱动）
导出 Word 的核心要求：用户在已导入的 ZIP 列表中选择一个或多个 ZIP，并在 ZIP 内文件列表中勾选需要导出的内容，最终批量汇总导出到**同一个** Word 文档（docx）中。

用户可选择导出内容范围：Word全部或部分内容（至少支持模板字段/关键段落/表格）；PDF某些内容（例如按页/按命中结果）；图片（选定图片应出现在导出的 Word 中）；视频必须随导出的 Word 文件一起带出（允许嵌入或作为附件）；原始 ZIP 可选，若勾选则必须随导出的 Word 文件一起带出（允许作为附件）。

导出结果：生成一个 Word 文件（docx），包含正文汇总内容（按一定结构组织，例如按ZIP分章/按类型分节）与附件/嵌入文件（视频、原始ZIP、必要时PDF本体等）。

## 6. 非功能需求
离线：不得依赖网络请求或云服务。  
性能与资源：低端机可用，避免高常驻内存；预览按需加载；批处理限流；可见进度与可取消；大文件处理避免一次性全量加载到内存。  
稳定性：失败可定位（明确错误信息）；单个 ZIP/单个文件失败不影响整体任务继续。  
可用性：明确的任务进度与状态提示；导出结果位置可配置/可打开所在目录。

## 7. 业务规则待确认（需要补充）
1. Word 模板字段清单与定位规则：字段名、位置锚点（内容控件tag/书签/表格坐标/标题规则等）
2. PDF “某些内容”的选择方式：页码范围 / 关键字命中 / 选区截图 / 书签标题等
3. 视频支持格式范围：至少 mp4？是否需要兼容多编码（H.264/H.265）？
4. 导出 Word 的组织结构：按 ZIP 分章？按文件类型分节？是否需要目录/编号？
5. Excel 导出字段与sheet规则：一批次一个sheet还是按zip分sheet？是否需要合计/校验？

## 8. 交付物（面向用户）
Windows 可安装程序或便携版程序；导出产物包括 Excel（结构化字段汇总）与 Word（汇总文档 + 附件/嵌入文件）。

## 9. 系统命名
名称：______档案盒______
英文名（可选）：____ArchiveBox________
